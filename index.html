<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MVP儀表板</title>
    
    <!-- PWA 設定 -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- 連結外部 CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="sidebar-overlay" onclick="toggleSidebar()"></div>

    <!-- 左側側邊欄 -->
    <div id="sidebar">
        <div class="sidebar-toggle-tab" onclick="toggleSidebar()" id="toggle-btn">&lt;</div>
        <div class="sidebar-header">
            <span>MVP儀表板</span>
            <button class="btn-icon" onclick="openSettings()" title="設定">⚙️</button>
        </div>

        <div class="sidebar-notify-settings">
            <div class="notify-row">
                <label><input type="checkbox" id="chk-use-float" onchange="saveSettings(); renderGrid();"> 浮動時間</label>
                <div class="notify-input-group">
                    <input type="number" id="inp-float-min" value="10" min="0" max="60" onchange="saveSettings(); renderGrid();">
                    <span>分</span>
                </div>
            </div>
            <div class="notify-row">
                <label><input type="checkbox" id="chk-notify-respawn" onchange="toggleRespawnSettings()"> 重生通知</label>
            </div>
            <div class="notify-row">
                <label id="lbl-notify-countdown"><input type="checkbox" id="chk-notify-countdown" onchange="saveSettings()"> 倒數通知</label>
                <div class="notify-input-group">
                    <input type="number" id="inp-notify-min" value="3" min="1" max="60" onchange="saveSettings()">
                    <span>分</span>
                </div>
            </div>
        </div>

        <div class="sidebar-content" id="sidebar-list"></div>

        <!-- 搜尋與排序 -->
        <div class="sidebar-search-area">
            <input type="text" id="sidebar-search" class="sidebar-search" placeholder="🔍 搜尋魔物..." oninput="renderSidebar()">
            <button class="btn-sort-trigger" onclick="openSortModal()">⇅</button>
        </div>

        <div class="sidebar-footer">
            <button class="btn-gray" onclick="toggleAll(true)">全選</button>
            <button class="btn-gray" onclick="toggleAll(false)">全取消</button>
        </div>
    </div>

    <!-- 右側主內容 -->
    <div id="main-content">
        <div id="card-container"></div>
    </div>

    <!-- 設定視窗 -->
    <div id="settings-modal">
        <div class="modal-content">
            <div class="modal-header">
                <span>設定</span>
                <button class="btn-icon" onclick="closeSettings()">✕</button>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <h3>一般設定</h3>
                    <label style="display:flex; align-items:center; gap:10px;">
                        <input type="checkbox" id="chk-theme" onchange="toggleTheme()" style="width:auto;">
                        使用淺色模式 (Light Mode) - 預設開啟
                    </label>
                </div>
                <div class="modal-section">
                    <h3>資料管理</h3>
                    <div style="display:flex; gap:10px; flex-wrap: wrap;">
                        <button class="btn-sync" onclick="syncDefaultMonsters()">同步官方/預設魔物</button>
                        <input type="file" id="import-file" accept=".json" style="display:none" onchange="importData(this)">
                        <button class="btn-import" onclick="document.getElementById('import-file').click()">匯入備份</button>
                        <button class="btn-gray" onclick="exportData()">匯出備份</button>
                    </div>
                    <div style="font-size:0.8em; color:var(--text-muted); margin-top:5px;">
                        * 同步：補齊缺少的預設魔物，若名稱相同則更新重生時間。<br>
                        * 匯入：合併檔案中的魔物，若名稱相同則更新重生時間。
                    </div>
                </div>
                <div class="modal-section">
                    <h3>新增魔物</h3>
                    <div style="display:flex; gap:10px; align-items: center;">
                        <input type="text" id="new-name" placeholder="名稱" style="flex:2">
                        <input type="number" id="new-time" placeholder="時" style="flex:1; min-width: 50px;">
                        <input type="number" id="new-time-min" placeholder="分" style="flex:1; min-width: 50px;">
                        <button class="btn-update" onclick="addNewMonster()">新增</button>
                    </div>
                </div>
                <div class="modal-section">
                    <h3>管理與排序清單</h3>
                    <div style="font-size:0.85em; color:var(--text-muted); margin-bottom:5px;">
                        勾選框：決定是否顯示於「側邊欄」。
                    </div>
                    <div id="manage-list-container"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 排序選單視窗 -->
    <div id="sort-modal">
        <div class="modal-content" style="width: 300px;">
            <div class="modal-header">
                <span>選擇排序方式</span>
                <button class="btn-icon" onclick="closeSortModal()">✕</button>
            </div>
            <div class="modal-body">
                <div class="sort-menu-list">
                    <div class="sort-option" onclick="selectSort('default')" id="sort-opt-default">預設 (新增順序)</div>
                    <div class="sort-option" onclick="selectSort('checked-first')" id="sort-opt-checked-first">已勾選優先</div>
                    <div class="sort-option" onclick="selectSort('name-asc')" id="sort-opt-name-asc">名稱 (A → Z)</div>
                    <div class="sort-option" onclick="selectSort('name-desc')" id="sort-opt-name-desc">名稱 (Z → A)</div>
                    <div class="sort-option" onclick="selectSort('time-asc')" id="sort-opt-time-asc">重生時間 (短 → 長)</div>
                    <div class="sort-option" onclick="selectSort('time-desc')" id="sort-opt-time-desc">重生時間 (長 → 短)</div>
                </div>
            </div>
        </div>
    </div>

    <!-- 連結外部 JS -->
    <script src="script.js"></script>
</body>
</html>
